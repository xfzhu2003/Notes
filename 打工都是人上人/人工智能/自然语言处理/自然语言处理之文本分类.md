# 自然语言处理之文本分类

## 前言
文本分类（又名文档分类）作为自然语言处理（Natural Language Processing，NLP）领域最经典的使用场景之一，是学习NLP必须要接触的一个研究方向。但作为人工智能研究方向之一的NLP作为一个交叉学科涉及的知识繁多，并且要求从业人员具备扎实的理论基础知识，这就为那些零基础的初学者带来了很大的麻烦。本篇文章作为笔者的学习笔记一起来与大家探讨一下这个问题。

文本分类积累了许多的实现方法。这里我们根据是否使用深度学习方法将文本分类主要分为一下两个大类：
- 基于传统机器学习的文本分类，如 TF-IDF文本分类。
- 基于深度学习的文本分类，如Facebook开源的FastText文本分类，Text-CNN 文本分类，Text-CNN 文本分类等。

## 一、大话文本分类
在我们探讨理论知识之前我们先来简单了解一下文本分类的流程。人工智能的根本目的就是让机器拥有人类的“脑子”，所以在很多方面都是仿照人类来实现相关技术，比如神经网络。文本分类也是如此，所以让我们来回顾一下人类处理文本分类的方式。

### 1.1 文本分类
文本分类的具体作用笔者在综述中提到过，通俗的将就是将文章分配到它对应的类别中去。例如一篇文章的内容是描述星座的，我们会把他归类到天文学里。另一篇文章讲述的是改革开放以来中国经济的发展，我们则会将他归类到经济里，这就是文本分类。

### 1.2 文本分类的处理流程
所以大家可能注意到上面一段话中的重点，我们发现文章的内容描述是如某类有关，就会把它分到某一类。但是我们是怎么得知文章的内容呢？这其实就是文本分类要解决的问题，怎么让机器知道这篇文章与什么有关。

我们在阅读文章时，首先会将句子划分为一个一个的词语（分词），然后将一些无意义的词语舍去（去停用词）或者整合到其他有意义的信息中。将整篇文章阅读后就得到了它所有的关键信息，然后根据关键信息的种类来分类。对于一些描述多方面内容的文章就会权衡关键信息的重要性，从而决定将其归档到具体的分类中（分类器）。不过有时我们也会创建新的分类来归档那些包含大量交叉信息的文章。

那我们们又是怎么判断这个词语是不是关键词的呢？通常就是在文中出现次数多的词语一般为关键词，特别在去除掉一些停顿词以后。所以一般我们会将出现次数多的有含义的词作为关键信息提取出来（特征提取）。最后，这片文章中的所有关键信息就代表了这片文章（文本表示）。

那我们为什么会知道这些关键信息对应到什么类别中呢？是因为我们接触的大量的实例，来告诉我们什么样的文章是属于什么样的类别，所以计算机同样需要这些信息。这就是所谓的训练过程，经过训练，程序（模型）就知道当文章中出现“xxx”这样的关键词时他的分类是“xxx”。当然以上的描述十分的笼统，大家可以先简单了解，当阅读完全部文章后就会理解上述描述的含义。

下面我们进入正题。

## 二、基于传统机器学习的文本分类
随着统计学习方法的发展，特别是在90年代后互联网在线文本数量增长和机器学习学科的兴起，逐渐形成了一套解决大规模文本分类问题的经典玩法，这个阶段的主要套路是人工特征工程+浅层分类模型。整个文本分类问题就拆分成了`特征工程`和`分类器`两部分。

### 2.1 特征工程
这里的特征工程也就是将文本表示为计算机可以识别的、能够代表该文档特征的特征矩阵的过程。在基于传统机器学习的文本分类中，我们通常将特征工程分为`文本预处理`、`特征提取`、`文本表示`等三个部分。

#### 2.1.1 文本预处理
文本预处理过程是提取文本中的关键词来表示文本的过程。中文文本预处理主要包括`文本分词`和`去停用词`两个阶段。

文本分词，是因为很多研究表明特征粒度为词粒度远好于字粒度（其实很好理解，因为大部分分类算法不考虑词序信息，基于字粒度显然损失了过多“n-gram”信息）。具体到中文分词，不同于英文有天然的空格间隔，需要设计复杂的分词算法。传统分词算法主要有基于字符串匹配的正向/逆向/双向最大匹配；基于理解的句法和语义分析消歧；基于统计的互信息/CRF方法。近年来随着深度学习的应用，WordEmbedding + Bi-LSTM+CRF方法逐渐成为主流，本文重点在文本分类，就不展开了。

而停止词是文本中一些高频的代词、连词、介词等对文本分类无意义的词，通常维护一个停用词表，特征提取过程中删除停用表中出现的词，本质上属于特征选择的一部分。

#### 2.1.2 特征提取
特征提取包括`特征选择`和`特征权重计算`两部分。

特征选择的基本思路是根据某个评价指标独立的对原始特征项（词项）进行评分排序，从中选择得分最高的一些特征项，过滤掉其余的特征项。常用的评价有：`文档频率`、`互信息`、`信息增益`、`χ²统计量`等。

特征权重计算主要是经典的TF-IDF方法及其扩展方法。TF-IDF的主要思想是一个词的重要度与在类别内的词频成正比，与所有类别出现的次数成反比。

#### 2.1.3 文本表示
文本表示的目的是把文本预处理后的结果转换成计算机可理解的方式，是决定文本分类质量最重要的部分。传统做法常用`词袋模型（BOW, Bag Of Words）`或`向量空间模型（Vector Space Model）`，最大的不足是忽略文本上下文关系，每个词之间彼此独立，并且无法表征语义信息。

### 2.2 分类器
大部分机器学习方法都在文本分类领域有所应用，比如朴素贝叶斯分类算法（Naïve Bayes）、KNN、SVM、最大熵和神经网络等等。

## 三、基于深度学习的文本分类
待续

链接：https://www.jianshu.com/p/56061b8f463a