# 第二章 线性规划

## 一、线性规划的描述形式

### 1.标准形式

把如下形式的线性规划
$$
\left.
\begin{aligned}
&min\ \vec{c}^T\vec{x}\\
&s.t.\ A\vec{x}=\vec{b}\\
&\quad\quad\vec{x}>0
\end{aligned}
\right\}\tag{2.1}
$$
称为线性规划的标准形式，其中$\vec{c}$称为价格系数，$\vec{b}$称为右端项。

其中
$$
\begin{aligned}
&\vec{x}=[x_1,x_2,...,x_n]^T,\\
&\vec{c}=[c_1,c_2,...,c_n]^T,\\
&\vec{b}=[b_1,b_2,...,b_n]^T,\\
&A=\begin{bmatrix}
 a_{11}&  a_{12}&  ...& a_{1n}\\ 
 a_{21}&  a_{22}&  ...& a_{2n}\\ 
 ...&  ...&  ...& ...\\ 
 a_{m1}&  a_{m2}&  ...&a_{mn} 
\end{bmatrix}
\end{aligned}
$$

### 2.典范形式

若$A$中有$m$个列向量可以合并为单位矩阵，且$\vec{b}\geq0$，则此时称为线性规划的典范形式：
$$
\left.
\begin{aligned}
&min\ \vec{c}_{I}^T\vec{x}_I+\vec{c}_N^T\vec{x}_N\\
&s.t.\ I\vec{x}_I+N\vec{x}_N=\vec{b}\\
&\quad\quad\vec{x}_I,\vec{x}_N>0
\end{aligned}
\right\}\tag{2.2}
$$
其中
$$
\begin{aligned}
\vec{c}_I&=[c_1,c_2,...,c_m]^T\quad\quad\quad\ \vec{c}_N=[c_{m+1},...,c_n]^T\\
\vec{x}_I&=[x_1,x_2,...,x_m]^T\quad\quad\quad \vec{x}_I=[x_{m+1},...,x_n]^T\\
I&=[\vec{a}_1,\vec{a}_2,...,\vec{a}_m]\quad\quad\quad\ \ \ N=[\vec{a}_{m+1},...,\vec{a}_n]\\
\vec{a}_j&=[a_{1j},a_{2j},...,a_{mj}]^T\\
\end{aligned}
$$
式中$I$是单位矩阵。

### 3.一般形式

如下形式的线性规划
$$
\left.
\begin{aligned}
&min\ \sum_{j=1}^ic_jx_j;\\
&s.t.\ \sum_{j=1}^t a_{pj}x_j \leq b_p,\quad p=1,2,...,u\\
&\quad\quad\sum_{j=1}^t a_{qj}x_j \geq b_q,\quad q=u+1,...,u+v\\
&\quad\quad\sum_{j=1}^t a_{rj}x_j = b_r,\quad r=u+v+1,...,m\\
&\quad\quad x_j \geq 0,\quad\quad j=1,2,...,t
\end{aligned}
\right\}\tag{2.3}
$$
称为线性规划的一般形式，式中$1\leq u\leq u+v \leq m$。不失一般性，假设所有右端项$b_i \geq 0 (i=1,2,...m)$。

### 4. 一般形式与标准形式的关系

#### （1）松弛变量

考虑“$\leq$”约束中第$p$个不等式
$$
\sum_{j=1}^ta_{pj}x_j \leq b_p
$$
引入非负变量$x_{t+p}$，迫使
$$
\sum_{j=1}^ta_{pj}x_j +x_{t+p}= b_p
$$

使不等式约束变成等式约束的变量$x_{t+p}$称为松弛变量。

#### （2）剩余变量

考虑“$\geq$”约束中第$q$个不等式
$$
\sum_{j=1}^ta_{qj}x_j \geq b_q
$$
引入非负变量$x_{t+q}$，迫使
$$
\sum_{j=1}^ta_{qj}x_j +x_{t+q}= b_q
$$

使不等式约束变成等式约束的变量$x_{t+q}$称为剩余变量。

#### （3）一般形式转化为标准形式

在引入u个松弛变量，v个剩余变量后，线性规划（2.3）转化为如下形式：
$$
\left.
\begin{aligned}
&min\ \sum_{j=1}^ic_jx_j;\\
&s.t.\ \sum_{j=1}^t a_{pj}x_j +x_{t+p}= b_p,\quad p=1,2,...,u\\
&\quad\quad\sum_{j=1}^t a_{qj}x_j +x_{t+q}= b_q,\quad q=u+1,...,u+v\\
&\quad\quad\sum_{j=1}^t a_{rj}x_j = b_r,\quad r=u+v+1,...,m\\
&\quad\quad x_j \geq 0,\quad\quad j=1,2,...,t+u+v
\end{aligned}
\right\}\tag{2.4}
$$
并且不难证明二者等价，故今后只讨论标准线性规划。

例题$2.1$：

把线性规划
$$
\begin{aligned}
&min\ 3x_1+4x_2;\\
&s.t.\ -x_1+2x_2\leq4\\
&\quad\quad-x_1+x_2\geq 1\\
&\quad\quad x_1+x_2=3\\
&\quad\quad x_1,x_2\geq 0
\end{aligned}
$$
化为标准形式。

解：对于第一个约束引入松弛变量$x_3$，对于第二个约束引入剩余变量$x_4$，则可转化为下列形式
$$
\begin{aligned}
&min\ 3x_1+4x_2;\\
&s.t.\ -x_1+2x_2+x_3=4\\
&\quad\quad-x_1+x_2+x_4= 1\\
&\quad\quad x_1+x_2=3\\
&\quad\quad x_1,x_2\geq 0
\end{aligned}
$$

#### （4）自由变量

以上讨论都要求变量的取值是非负的。如果实际问题没有这种约束，也就是说某些变量可以任意取值。那么称这些变量为自由变量。自由变量有两种办法消去。

第一种方法：引入两个变量$x_1^+ \geq0,x_1^-\geq0$，令
$$
x_1=x_1^++x_1^-
$$
将此式带入到线性规划的目标函数和约束函数中，就可以消去自由变量$x_1$。

第一种方法：取一个含有$x_1$的等式约束，例如
$$
a_{i1}x_1+a_{i2}x_2+...+a_{in}x_n=b_i
$$
由此解出
$$
x_1=\frac{b_i}{a_{i1}}-\frac{a_{i2}}{a_{i1}}x_2+...+\frac{a_{in}}{a_{i1}}x_n
$$
将此式带入到线性规划的目标函数和约束函数中，就可以消去自由变量$x_1$。

第一种方法将增加变量数目，导致问题维度增大，第二种方法正好相反。

##  二、线性规划的解的性质

定理 $2.2.1$：

线性规划的容许集是凸多面体。

---

定义 $2.2.1$：

设$\vec{x_1},\vec{x_2} \in R^n$，且$\vec{x_1}\neq\vec{x_2}$，则$\vec{x_1}$和$\vec{x_2}$的凸组合的集合称为线段，$\vec{x_1}$和$\vec{x_2}$称为线段上的端点。若$\vec{x}$是$\vec{x_1}$和$\vec{x_2}$的严格凸组合，则称$\vec{x}$为线段的内点。

---

定义 $2.2.2$：

若凸集$D$中的某个点$\vec{x}$不能表示为这个集合另外两个点的严格凸组合，则称$\vec{x}$为凸集$D$的极点。

---

定义 $2.2.3$：

$A$的$m$个线性无关列向量称为基。基中的每个列向量称为基向量，而A中的其余列向量称为非基向量。由全体基向量合成的矩阵称为基矩阵，也简称基。若基是单位矩阵，则成为标准基。

---

定义 $2.2.4$：

在约束$\sum_{j=1}^{n}x_ja_j=b$ 中，确定一个基后，与基向量对应的变量称为基变量，与非基向量对应的变量称为非基变量。

---

定义 $2.2.5$：

设$\vec{x_0}$是$A\vec{x}=\vec{b}$ 的一个解。若它有$m$个分量所对应的$A$的列向量构成基$B$，而剩余$n-m$个分量全部为$0$。则称$\vec{x_0}$为约束$A\vec{x}=\vec{b}$关于基B的基本解，若还满足$\vec{x_0}\geq0$，则称$\vec{x_0}$为约束$A\vec{x}=\vec{b},\ \vec{x}\geq0$关于基B的基本容许解。

简单的说，在确定基后，所有非基变量取值都为$0$的解为基本解，所有非基变量取值都为$0$的容许解为基本容许解。

---

例题$2.2$：求如下约束
$$
\begin{aligned}
&x_1+x_2+x_3=6,\\
&x_1+2x_2+4x_3=18,\\
&x_1,x_2,x_3 \geq0
\end{aligned}
$$
的所有基本容许解。

解：列向量$\vec{a_1}=[1,1]^T,\vec{a_2}=[1,2]^T,\vec{a_3}=[1,4]^T$两两线性无关。。可以组成$3$个基。

- 取$B_1=[\vec{a_1},\vec{a_2}]$为基，则$x_1,x_2$为基变量，$x_3$为非基变量。令$x_3=0$，得
  $$
  x_1+x_2=6,\\
  x_1+2x_2=18,
  $$
  由此解出$x_1=-6,x_2=12$。因此$\vec{x_1}=[-6,12,0]^T$是基本解，但由于$x_1=-6\leq0$，因此$\vec{x_1}$不是基本容许解。

- 取$B_2=[\vec{a_2},\vec{a_3}]$为基，则$x_2,x_3$为基变量，$x_1$为非基变量。令$x_1=0$，得
  $$
  x_2+x_3=6,\\
  2x_2+4x_3=18,
  $$
  由此解出$x_2=x_3=3$。因此$\vec{x_2}=[0,3,3]^T$是基本容许解。

- 取$B_3=[\vec{a_1},\vec{a_3}]$为基，则$x_1,x_3$为基变量，$x_2$为非基变量。令$x_2=0$，得
  $$
  x_1+x_3=6,\\
  x_1+4x_3=18,
  $$
  由此解出$x_1=2,x_3=4$。因此$\vec{x_3}=[2,0,4]^T$是基本容许解。

定义 $2.2.6$：

设$B$是约束函数的一个基，若约束函数存在关于基$B$的基本容许解，则称$B$为约束函数的容许基。否则称为非容许基。若容许基是单位矩阵，则称为标准容许基。

---

定义 $2.2.7$：

若基本解中基变量的取值都不为0，则该解称为非退化的，否则称为退化的。若约束函数的所有基本容许解都是非退化的，则线性规划称为非退化的，否则称为退化的。

例题$2.3$：求如下约束
$$
\begin{aligned}
&x_1+x_2+x_3=6,\\
&x_1+2x_2+4x_3=12,\\
&x_1,x_2,x_3 \geq0
\end{aligned}
$$
的所有基本容许解。

解：本题与例题$2.2$有相同的列向量$\vec{a_1},\vec{a_3},\vec{a_2}$，因此有三个相同的基：$B_1=[\vec{a_1},\vec{a_2}],B_2=[\vec{a_2},\vec{a_3}],B_3=[\vec{a_1},\vec{a_3}]$。采用例题$2.2$的解法可得到如下结果：

- 关于$B_1$的基本容许解$\vec{x_1}=[0,6,0]^T$是一个退化解。
- 关于$B_2$的基本容许解$\vec{x_2}=[0,6,0]^T$是一个退化解。
- 关于$B_3$的基本容许解$\vec{x_3}=[4,0,2]^T$是一个非退化解。

可以证明的是$A\vec{x}=\vec{b},\vec{x}\geq0$ 的基本容许解与这组约束所确定的容许集的极点在一定条件下是一一对应的。

---

定理 $2.2.2$：

标准线性规划$(2.1)$若有容许解，则必有基本容许解。

---

定理 $2.2.3$：

标准线性规划$(2.1)$若有最优解，则必有最有基本容许解。

标准线性规划$(2.1)$若有最优解，则其容许集的某个极点必定是最优解。

---

##  三、单纯形法

考虑标准线性规划
$$
\left.
\begin{aligned}
&min\ \vec{c}^T\vec{x}\\
&s.t.\ A\vec{x}=\vec{b}\\
&\quad\quad\vec{x}>0
\end{aligned}
\right\}\tag{2.1}
$$
其中A是秩为m











